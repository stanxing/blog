(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{220:function(s,t,a){"use strict";a.r(t);var n=a(6),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"数据降采样"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据降采样"}},[s._v("#")]),s._v(" 数据降采样")]),s._v(" "),a("p",[s._v("降采样就是通过聚合等手段将时间窗口较小的高精度的数据转换成时间窗口较大的低精度的数据的过程。通过降采样，牺牲一点精度，依旧可以保留曲线的形状，减少存储压力。")]),s._v(" "),a("p",[s._v("监控数据的采集频率一般是相对较短的，比如 10s，因此每天会产生大量的数据，但是这些数据在保留一定时间后，它的实时性就没那么高了，长时间存储这些高精度的数据对存储会是很大的压力。一个很自然的方式就是对数据进行采样，对高精度的数据存较短的时间，对于低精度的数据可以保存的更久一些甚至是永久。")]),s._v(" "),a("h2",{attrs:{id:"inlfuxdata-架构下实现降采样的两种方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#inlfuxdata-架构下实现降采样的两种方式"}},[s._v("#")]),s._v(" inlfuxdata 架构下实现降采样的两种方式")]),s._v(" "),a("p",[s._v("以一个例子来介绍降采样的场景：")]),s._v(" "),a("p",[s._v("假设我们以每 10s 写入一个数据点来追踪餐厅通过电话和网站订购外卖的订单数量。我们把数据存在 "),a("code",[s._v("food_data")]),s._v(" 数据库中，其 measurment 为 "),a("code",[s._v("orders")]),s._v("， fields 分别是 "),a("code",[s._v("phone")]),s._v(" 和 "),a("code",[s._v("website")]),s._v("。就像下面这样：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("name: orders\n------------\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v("                           phone     website\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-10T23:18:00Z     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-10T23:18:10Z     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-10T23:18:20Z     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("假设在长时间的运行中，我们只关心 30 分钟内通过通过收集和网站订购的平均数量，我们要对上面的数据实现以下几点要求：")]),s._v(" "),a("ul",[a("li",[s._v("自动将 10s 间隔的数据聚合成 30 分钟间隔的数据")]),s._v(" "),a("li",[s._v("自动删除两个小时以上的原始 10s 间隔的数据")]),s._v(" "),a("li",[s._v("自动删除超过 90 天的 30分钟间隔的数据")])]),s._v(" "),a("p",[s._v("###　准备工作")]),s._v(" "),a("ul",[a("li",[s._v("创建数据库和 retention policy")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建数据库时，InfluxDB会自动生成一个叫做 autogen 的 RP，并作为数据库的默认 RP，autogen 这个 RP 会永远保留数据。在输入上面的命令之后，two_hours 会取代 autogen 作为food_data 的默认 RP。")]),s._v("\nCREATE DATABASE "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"food_data"')]),s._v("\nCREATE RETENTION POLICY "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"two_hours"')]),s._v(" ON "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"food_data"')]),s._v(" DURATION 2h REPLICATION "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" DEFAULT\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个保留 90d 数据的 RP")]),s._v("\nCREATE RETENTION POLICY "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"90_days"')]),s._v(" ON "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"food_data"')]),s._v(" DURATION 90d REPLICATION "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"continuous-query-retention-poilcy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#continuous-query-retention-poilcy"}},[s._v("#")]),s._v(" Continuous Query + Retention Poilcy")]),s._v(" "),a("p",[s._v("创建 CQ：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("CREATE CONTINUOUS QUERY "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cq_30m"')]),s._v(" ON "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"food_data"')]),s._v(" BEGIN\n  SELECT mean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"website"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" AS "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mean_website"')]),s._v(",mean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"phone"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" AS "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mean_phone"')]),s._v("\n  INTO "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"90_days"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"downsampled_orders"')]),s._v("\n  FROM "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"orders"')]),s._v("\n  GROUP BY time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("30m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nEND\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("上面创建了一个 cq 叫做 "),a("code",[s._v("ca_30m")]),s._v(" 作用于 "),a("code",[s._v("food_data")]),s._v(" 上。这个 CQ 告诉 influxdb 每隔 30分钟计算一次，从 "),a("code",[s._v("orders")]),s._v(" 表中 group by 30 分钟的数据，计算 "),a("code",[s._v("phone")]),s._v(" 和 "),a("code",[s._v("website")]),s._v(" 的平均值，并将记录写入 "),a("code",[s._v("90_days.downsampled_orders")]),s._v(" 表中，该表的 retention policy 是 90 天。注意某个表使用的不是默认的 retention policy，就需要在表名前显式的指定。")]),s._v(" "),a("p",[s._v("最后的结果如下：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SELECT * FROM "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"orders"')]),s._v(" LIMIT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\nname: orders\n---------\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v("                            phone  website\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T23:00:00Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T23:00:10Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T23:00:20Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T23:00:30Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T23:00:40Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SELECT * FROM "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"90_days"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"downsampled_orders"')]),s._v(" LIMIT "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\nname: downsampled_orders\n---------------------\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v("                            mean_phone  mean_website\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T15:00:00Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T15:30:00Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T16:00:00Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T16:30:00Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2016")]),s._v("-05-13T17:00:00Z      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h3",{attrs:{id:"使用-kapacitor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-kapacitor"}},[s._v("#")]),s._v(" 使用 kapacitor")]),s._v(" "),a("p",[s._v("使用 batch 模式：")]),s._v(" "),a("div",{staticClass:"language-javaScript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("batch\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\n        SELECT mean("website") AS "mean_website", mean("phone") AS "mean_phone" FROM "food_data"."two_hours"."orders"\n        ')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("period")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("every")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("influxDBOut")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("database")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'90_days'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("retentionPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'downsampling_orders'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("使用 stream 模式，这里需要注意，tick 脚本的 mean Node 无法处理多个字段，所以要分离出两个 stream 单独处理，再通过 join 将两个流连接，参考"),a("a",{attrs:{href:"https://community.influxdata.com/t/kapacitor-stream-processing-multiple-fields/3240/11",target:"_blank",rel:"noopener noreferrer"}},[s._v("kapacitor-stream-processing-multiple-fields"),a("OutboundLink")],1),s._v("：")]),s._v(" "),a("div",{staticClass:"language-javaScript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" stream\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("measurement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'orders'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("window")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("period")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("every")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" mean_website "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" data\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'website'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("as")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mean_website'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" mean_phone "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" data\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'phone'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("as")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mean_phone'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmean_website\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mean_phone"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("influxDBOut")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("database")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'90_days'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("retentionPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'downsampling_orders'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://jasper-zhang1.gitbooks.io/influxdb/content/Guide/downsampling_and_retention.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("downsampling_and_retention"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.youtube.com/watch?v=j3x0TohyGJY",target:"_blank",rel:"noopener noreferrer"}},[s._v("downsampling your data"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);